# Интегрированные решения XML: статус сообщений

Статусы сообщений содержат информацию о текущем состоянии сообщения, регулярно обновляются и могут быть запрошены в любое время.

Для того, чтобы запросить статус SMS, необходимо сделать запрос на адрес `http://kazinfoteh.org:809/api`. Мы принимаем запросы, отправленные методом `POST` в формате `XML`.

Например:

```xml
<?xml version="1.0" encoding="utf-8" ?>
<package login="demo" password="demo">
    <status>
        <msg id="1"/>
        <msg sms_id="2"/>
    </status>
</package>
```

## Параметры запроса:

Кодировка `XML` обязательно должна быть `UTF-8`.

| Тег | Назначение                               |
|-----|------------------------------------------|
| msg | тег, определяющий отправляемое сообщение |

| Атрибут   | Назначение |
|-----------|------------|
| id        | пользовательский числовой идентификатор сообщения, необязательный атрибут, возвращается при указании данного атрибута при отправке |
| sms_id    | числовой идентификатор сообщения, присвоенный шлюзом |

## Параметры в ответе:

В ответ на запрос возвращается `XML` документ содержащий статусы для запрошенных сообщений, либо соответствующие коды ошибок.

| Тег | Назначение                                                         |
|-----|--------------------------------------------------------------------|
| msg | тег, определяющий отправляемое сообщение; содержит код статуса SMS |

| Атрибут        | Назначение |
|----------------|------------|
| id             | пользовательский числовой идентификатор сообщения, необязательный атрибут, возвращается при указании данного атрибута в запросе |
| sms_id         | числовой идентификатор сообщения, присвоенный шлюзом |
| sms_count      | реальное количество SMS к отправке
| date_completed |  дата присвоения финального статуса

Пример ответа:

```xml
<?xml version="1.0" encoding="utf-8" ?>
<package>
    <status>
        <msg id="1" sms_id="1" sms_count="1" date_completed="2001-01-01T12:00:00">102</msg>
        <msg sms_id="2" sms_count="1">1</msg>
    </status>
</package>
```

## Коды статусов SMS:

Статусы сообщений:

| Код | Значение      |
|----:|:--------------|
| 100 | SCHEDULED     |
| 101 | ENROUTE       |
| 102 | DELIVERED     |
| 103 | EXPIRED       |
| 104 | DELETED       |
| 105 | UNDELIVERABLE |
| 106 | ACCEPTED      |
| 107 | UNKNOWN       |
| 108 | REJECTED      |
| 109 | DISCARDED     |

Статусы `100 SCHEDULED` и `106 ACCEPTED` являются промежуточными и могут быть изменены в ходе обработки. Остальные статусы являются конечными и дополнительного запроса по изменению статуса не требуют.

Cтатусы ошибок:

| Код | Значение      |
|----:|:--------------|
| 200 | UNKNOWN       |
| 201 | ID            |
| 202 | SENDER        |
| 203 | RECIPIENT     |
| 204 | LENGTH        |
| 205 | USER_DISABLE  |
| 206 | BILLING       |
| 207 | OVERLIMIT     |
